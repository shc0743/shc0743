<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>shc0743's profile</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="res/css/main.css">
    <link rel="stylesheet" type="text/css" href="res/css/index-page.css">
    <script src="res/js/getUrlValue.js"></script>
    <script src="res/js/vue.js"></script>
    <script src="res/js/preload.js"></script>
    <script src="//shc7432.github.io/public/something/dialog.js"></script>
    <style>

    </style>
</head>

<body>

    <div id=top_lang_change_bar class="top-bar bgcolor-info width-full" hidden>
        This article is also available in <a href="tr/en/">English</a>.
        <a class="btn close-button" onclick="this.parentElement.remove()" title=Close></a>
        <div class="btn no-show-again" hidden><a href=#>Do not show again</a></div>
    </div>

    <nav id=nav_bar>
        <a href="//github.com/shc0743" title="shc0743 on GitHub">
            <img src="res/i/icon.png" alt="Icon" width="32" height="32" />
        </a>
    </nav>

    <main>
        <div id=div_show_README>
            <div class="main load-loading">
                <span></span>
                <span></span>
                <span></span>
                <span></span>
                <span></span>
            </div>
            Loading...
        </div>
    </main>

    <div id=errdlg_at_fetch_translate hidden>
        <dialogtitle>Error<a class=closebtn>x</a></dialogtitle>
        <div>
            There is a error occurred while fetch translate.<br>
            Error info:<br>
            <textarea style="width:95%" rows=6></textarea><br>
            <button class=a>Abort</button>
            <button class=r>Retry</button>
            <button class=i>Ignore</button>
        </div>
    </div>

    <script>
    function getScrollbarWidth(el=null) {
        if (el) {
            return el.offsetWidth - el.clientWidth;//相减
        }
        var odiv = document.createElement('div'),//创建一个div
            styles = {
                width: '100px',
                height: '100px',
                overflowY: 'scroll'//让她有滚动条
            }, i, scrollbarWidth;
        for (i in styles) odiv.style[i] = styles[i];
        document.body.appendChild(odiv);//把div添加到body中
        var scrollbarWidth = odiv.offsetWidth - odiv.clientWidth;//相减
        odiv.remove();//移除创建的div
        return scrollbarWidth;//返回滚动条宽度
    }
    (function () {
        document.querySelector('main').style.top = top_lang_change_bar.clientHeight + 'px';
        top_lang_change_bar.style.width = document.documentElement.clientWidth - 20 - 
            getScrollbarWidth() + 'px';
        top_lang_change_bar.oncontextmenu = function(e){
            e.preventDefault();
            let el = top_lang_change_bar.querySelector('div.no-show-again');
            if (el) el.hidden = false;
        }
        let top_lang_change_bar_nsa = top_lang_change_bar.querySelector('div.no-show-again');
        if (top_lang_change_bar_nsa) 
            top_lang_change_bar_nsa.onclick = function () {
                site_data.top_lang_change_bar_hide = true;
                site_data.update(true);
                this.parentElement.remove();
                return false;
            }
        if(site_data.top_lang_change_bar_hide) top_lang_change_bar.remove();
    })()
    fetch("res/tr/zh-CN/json/index.html.json")
    .then(function (d) {
        return d.json();
    }, function (e) {
        console.error("Error while fetch translate: ", e);
        errdlg_at_fetch_translate.querySelector('div textarea').value = e;
        errdlg_at_fetch_translate.querySelector('div button.a').onclick = function () {
            window.close();
        }
        errdlg_at_fetch_translate.querySelector('div button.r').onclick = function () {
            location.reload();
        }
        errdlg_at_fetch_translate.querySelector('div button.i').onclick = function () {
            CreateDialogEx.remove(errdlg_at_fetch_translate);
        }
        CreateDialog(errdlg_at_fetch_translate, true);
    })
    .then(function (data) {
        const vue_obj = {
            data() {
                return data;
            }
        };
        Vue.createApp(vue_obj).mount("main");
    }, function (e) {
        console.error("Error while fetch translate: ", e);
        errdlg_at_fetch_translate.querySelector('div textarea').value = e;
        errdlg_at_fetch_translate.querySelector('div button.a').onclick = function () {
            window.close();
        }
        errdlg_at_fetch_translate.querySelector('div button.r').onclick = function () {
            location.reload();
        }
        errdlg_at_fetch_translate.querySelector('div button.i').onclick = function () {
            CreateDialogEx.remove(errdlg_at_fetch_translate);
        }
        CreateDialog(errdlg_at_fetch_translate, true);
    });
    fetch("res/tr/zh-CN/html/index.html.main%23div_show_README.html")
    .then(function(d){return d.text()})
    .then(function(v){
        document.querySelector('#div_show_README').innerHTML = v;
        if(top_lang_change_bar)
        top_lang_change_bar.style.width = document.documentElement.clientWidth - 20 - 
            getScrollbarWidth(document.querySelector('main')) + 'px';
    })
    </script>
</body>

</html>